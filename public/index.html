<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wikipedia</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    .did-you-know {
      background-color: #f9f9f9;
      border-left: 5px solid #2196F3;
      font-family: Arial, sans-serif;
      margin: 20px auto;
      max-width: 600px;
      padding: 15px;
    }
    .did-you-know h3 {
      color: #2196F3;
      margin-top: 0;
    }
    .did-you-know p {
      font-size: 1.1em;
      margin: 10px 0 0 0;
    }
    .featured-card {
      background: var(--card-bg);
      border-radius: 10px;
      box-shadow: 0 2px 8px var(--shadow-color);
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      margin-bottom: 0;
      min-height: 180px;
      padding: 24px 20px 18px 20px;
      transition: box-shadow 0.2s;
    }
    .featured-card h2 {
      color: var(--primary-color);
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 14px;
      margin-top: 0;
    }
    .featured-card li {
      font-size: 1rem;
      line-height: 1.5;
      margin-bottom: 8px;
    }
    .featured-card span {
      color: var(--text-color);
      opacity: 0.85;
    }
    .featured-card ul {
      color: var(--text-color);
      margin: 0;
      padding-left: 18px;
    }
    .featured-section-grid {
      display: grid;
      gap: 24px;
      grid-template-columns: 1fr 1fr;
      grid-template-rows: auto auto;
      margin-bottom: 40px;
    }
    .lang-group-title {
      color: #222;
      font-weight: bold;
      margin-bottom: 4px;
    }
    .lang-list {
      color: #0645ad;
      font-size: 1em;
      line-height: 1.7;
      margin-bottom: 6px;
      word-break: break-word;
    }
    .languages-group {
      margin-bottom: 18px;
    }
    .languages-panel {
      margin-top: 32px;
    }
    .languages-panel h3,
    .sister-projects-panel h3 {
      background: #eaecf0;
      border-bottom: 1px solid #a2a9b1;
      border-radius: 4px 4px 0 0;
      font-size: 1.2em;
      margin-top: 0;
      padding: 8px 12px;
    }
    .languages-panel p,
    .sister-projects-panel p {
      margin-bottom: 18px;
      margin-top: 8px;
    }
    .logo {
      align-items: center;
      color: var(--text-color);
      display: flex;
      font-size: 1.2rem;
      font-weight: bold;
      gap: 12px;
      text-decoration: none;
    }
    .logo-globe {
      height: 40px;
      min-width: 40px;
      object-fit: contain;
      width: 40px;
    }
    .logo-tagline {
      height: 16px;
      margin-left: 2px;
      opacity: 0.8;
      width: auto;
    }
    .logo-text {
      display: flex;
      flex-direction: column;
      justify-content: center;
      line-height: 1.1;
    }
    .logo-wordmark {
      height: 28px;
      margin-bottom: 2px;
      width: auto;
    }
    .main-container {
      overflow: hidden;
    }
    .nav-left {
      align-items: center;
      display: flex;
      gap: 12px;
    }
    .nav-link {
      align-items: center;
      background-color: #0078D7; /* Updated primary color */
      border-radius: 6px;
      color: white;
      display: flex;
      font-weight: 500;
      gap: 8px;
      padding: 10px 20px; /* Uniform size */
      text-decoration: none;
      transition: all 0.3s ease;
      font-size: 1rem; /* Consistent font size */
    }
    .nav-link:hover {
      background-color: #005A9E; /* Updated hover color */
      transform: translateY(-2px);
    }
    .nav-links {
      display: flex;
      gap: 12px; /* Adjusted spacing */
    }
    .nav-menu-btn {
      align-items: center;
      background: #0078D7; /* Updated button color */
      border: none;
      border-radius: 6px;
      color: white;
      cursor: pointer;
      display: flex;
      font-size: 1.5rem;
      padding: 10px; /* Uniform size */
      transition: background-color 0.3s ease;
    }
    .nav-menu-btn:hover {
      background-color: #005A9E; /* Updated hover color */
    }
    .nav-overlay {
      align-items: flex-start;
      background: rgba(0,0,0,0.6);
      display: none;
      height: 100vh;
      justify-content: flex-start;
      left: 0;
      position: fixed;
      top: 0;
      width: 100vw;
      z-index: 20000;
    }
    .nav-overlay-content {
      animation: slideInNav 0.25s cubic-bezier(.4,0,.2,1);
      background: var(--card-bg, #fff);
      border-radius: 0 12px 12px 0;
      box-shadow: 2px 0 16px rgba(0,0,0,0.18);
      display: flex;
      flex-direction: column;
      gap: 18px;
      max-width: 90vw;
      min-height: 100vh;
      padding: 32px 24px 24px 24px;
      position: relative;
      width: 320px;
    }
    .nav-overlay-content h3 {
      color: var(--primary-color);
      font-size: 1.1em;
      font-weight: 600;
      margin: 0 0 8px 0;
    }
    .nav-overlay-list {
      list-style: none;
      margin: 0 0 18px 0;
      padding: 0;
    }
    .nav-overlay-list a {
      color: var(--text-color);
      font-size: 1.05em;
      text-decoration: none;
      transition: color 0.2s;
    }
    .nav-overlay-list a:hover {
      color: var(--primary-color);
      text-decoration: underline;
    }
    .nav-overlay-list li {
      margin-bottom: 10px;
    }
    .nav-overlay.open {
      display: flex;
    }
    .random-article-button {
      align-items: center;
      background-color: var(--primary-color);
      border: none;
      border-radius: 4px;
      color: white;
      cursor: pointer;
      display: flex;
      font-weight: 500;
      gap: 6px;
      padding: 8px 16px;
      text-decoration: none;
      transition: all 0.3s ease;
    }
    .random-article-button::before {
      content: '🎲';
    }
    .random-article-button:hover {
      background-color: var(--primary-hover);
      transform: translateY(-2px);
    }
    .search-autocomplete-container {
      position: relative;
      width: 100%;
    }
    .sister-project {
      align-items: flex-start;
      background: #fff;
      border: 1px solid #c8ccd1;
      border-radius: 6px;
      box-shadow: 0 1px 2px rgba(0,0,0,0.03);
      display: flex;
      flex-direction: column;
      font-size: 1em;
      min-height: 70px;
      padding: 12px 10px 10px 10px;
    }
    .sister-project .icon {
      font-size: 1.5em;
      margin-bottom: 2px;
      margin-right: 6px;
      vertical-align: middle;
    }
    .sister-project a {
      color: #3366cc;
      font-weight: bold;
      text-decoration: none;
    }
    .sister-project a:hover {
      text-decoration: underline;
    }
    .sister-project span {
      color: #222;
      font-size: 0.97em;
      font-weight: normal;
    }
    .sister-projects-grid {
      display: grid;
      gap: 18px 24px;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      margin-bottom: 18px;
      margin-top: 12px;
    }
    .toc-level-h3 { margin-left: 16px; }
    .toc-level-h4 { margin-left: 32px; }
    .toc-panel {
      background: #f8f9fa;
      border: 1px solid #a2a9b1;
      border-radius: 6px;
      margin-bottom: 18px;
      max-width: 600px;
      padding: 12px 18px;
    }
    .toc-panel a {
      color: #3366cc;
      text-decoration: none;
    }
    .toc-panel a:hover {
      text-decoration: underline;
    }
    .toc-panel li {
      margin-bottom: 4px;
    }
    .toc-panel ul {
      list-style: none;
      margin: 0;
      padding-left: 0;
    }
    .wiki-sisters-languages {
      background: #f8f9fa;
      border: 1px solid #a2a9b1;
      border-radius: 6px;
      font-family: Arial, sans-serif;
      font-size: 1em;
      margin: 40px auto 0 auto;
      max-width: 1100px;
      padding: 24px 18px 32px 18px;
    }
    #searchSuggestions {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 4px;
      box-shadow: 0 2px 4px var(--shadow-color);
      list-style: none;
      margin-top: 0;
      max-height: 300px;
      overflow-y: auto;
      padding: 0;
      position: absolute;
      width: 100%;
      z-index: 1000;
    }
    #searchSuggestions li {
      color: var(--text-color);
      cursor: pointer;
      padding: 12px 15px;
      transition: background-color 0.2s ease;
    }
    #searchSuggestions li:hover {
      background-color: var(--primary-color);
      color: white;
    }
    #searchSuggestions li:not(:last-child) {
      border-bottom: 1px solid var(--border-color);
    }
    @keyframes slideInNav {
      from { transform: translateX(-100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    @media (max-width: 600px) {
      .nav-overlay-content {
        padding: 20px 10px 18px 10px;
        width: 90vw;
      }
      .sister-projects-grid {
        grid-template-columns: 1fr;
      }
      .wiki-sisters-languages {
        font-size: 0.97em;
      }
    }
    @media (max-width: 900px) {
      .featured-section-grid {
        grid-template-columns: 1fr;
        grid-template-rows: auto;
      }
      .sister-projects-grid {
        grid-template-columns: 1fr 1fr;
      }
      .wiki-sisters-languages {
        padding: 10px 2vw 18px 2vw;
      }
    }
    .close-nav-overlay {
      align-items: center;
      background: #dc3545;
      border: none;
      border-radius: 50%;
      color: #fff;
      cursor: pointer;
      display: flex;
      font-size: 1.3rem;
      height: 36px;
      justify-content: center;
      position: absolute;
      right: 16px;
      top: 16px;
      transition: background 0.2s;
      width: 36px;
      z-index: 2;
    }
    .close-nav-overlay:hover {
      background: #b52a37;
    }
    .nav-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 20px;
      background-color: #F3F4F6; /* Light background for contrast */
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Subtle shadow */
    }
    .search-button {
      background-color: #0078D7; /* Updated button color */
      border: none;
      border-radius: 6px;
      color: white;
      cursor: pointer;
      padding: 10px 20px; /* Uniform size */
      font-size: 1rem;
      transition: background-color 0.3s ease;
    }
    .search-button:hover {
      background-color: #005A9E; /* Updated hover color */
    }
    .search-container input {
      border: 1px solid #ccc;
      border-radius: 6px;
      padding: 10px;
      font-size: 1rem;
      width: 200px;
    }
    .search-container input:focus {
      outline: none;
      border-color: #0078D7;
      box-shadow: 0 0 4px #0078D7;
    }
    .main-nav {
      background-color: #004080; /* Bold background color */
      color: white;
      font-size: 1.2rem; /* Larger font size */
      font-weight: bold;
      padding: 15px 20px; /* Add padding for better spacing */
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Subtle shadow for depth */
    }
    .main-nav a {
      color: white; /* Ensure links are visible */
      text-decoration: none;
    }
    .main-nav a:hover {
      text-decoration: underline; /* Add hover effect for links */
    }
  </style>
</head>
<body>
  <nav class="main-nav">
    <div class="nav-container">
      <div class="nav-left">
        <button id="navMenuBtn" class="nav-menu-btn" aria-label="Open menu">☰</button>
        <a href="#" class="logo">
          <img src="https://en.wikipedia.org/static/images/icons/wikipedia.png" alt="Wikipedia globe" class="logo-globe">
          <span class="logo-text">
            <img src="https://en.wikipedia.org/static/images/mobile/copyright/wikipedia-wordmark-en.svg" alt="Wikipedia" class="logo-wordmark">
            <img src="https://en.wikipedia.org/static/images/mobile/copyright/wikipedia-tagline-en.svg" alt="The Free Encyclopedia" class="logo-tagline">
          </span>
        </a>
        <div class="search-container">
          <div class="search-autocomplete-container">
            <input type="text" id="searchInput" placeholder="Search Wikipedia..." oninput="getSearchSuggestions()">
            <ul id="searchSuggestions"></ul>
          </div>
          <button onclick="searchWikipedia()" class="search-button">Search</button>
        </div>
      </div>
      <div class="nav-right">
        <div class="nav-links">
          <a href="random.html" class="nav-link">
            <span>🎲</span>
            Random Articles
          </a>
          <a href="summarizer.html" class="nav-link">
            <span>📝</span>
            Summarizer
          </a>
          <a href="qa.html" class="nav-link">
            <span>❓</span>
            Q&A Bot
          </a>
          <a href="quiz.html" class="nav-link">
            <span>📚</span>
            Quiz Generator
          </a>
        </div>
      </div>
    </div>
  </nav>

  <div class="main-container">
    <main class="content">
      
      <div class="card featured-section-grid">
        <section class="main-featured featured-card">
          <h2>From today's featured article</h2>
          <div class="featured-content" style="min-height:200px;">
            <!-- Featured article content will be dynamically loaded -->
          </div>
        </section>
        <section class="onthisday-featured featured-card">
          <h2>On this day</h2>
          <div class="onthisday-content" style="min-height:200px;">
            <!-- On this day content will be dynamically loaded -->
          </div>
        </section>
        <section class="news-featured featured-card">
          <h2>In the news</h2>
          <div class="news-content">
            <ul>
              <li><strong>China Zorrilla: World's Largest Electric Ferry Launched:</strong> Uruguay has introduced the "China Zorrilla," the world's largest electric ferry, equipped with a groundbreaking 40 MWh battery. This development marks a significant advancement in maritime electrification and sustainable transportation.</li>
              <li><strong>India Among Top Five Military Spenders:</strong> According to recent data from the Stockholm International Peace Research Institute, India has become one of the world's top five military spenders. This reflects a broader trend of increasing global defense budgets.</li>
              <li><strong>Met Gala 2025 Celebrates Black Designers:</strong> The Met Gala, held in New York, is focusing exclusively on Black designers for the first time. The event, hosted by Pharrell Williams, aims to highlight and celebrate the contributions of Black creatives in the fashion industry.</li>
              <li><strong>U.S. Seeks Fair Trade Deal with China:</strong> President Donald Trump announced that the U.S. is engaging with multiple countries, including China, to secure fair trade agreements. He emphasized the importance of achieving a balanced deal with China.</li>
              <li><strong>USA Luge Announces 2025 National Team:</strong> USA Luge has unveiled its 2025 National Team, featuring seven Olympic athletes. The team is preparing for upcoming international competitions, aiming to build on past successes and achieve new milestones.</li>
              <li><strong>World Happiness Report 2025 Released:</strong> Finland has been ranked as the happiest country for the eighth consecutive year. Other countries like Mexico, Norway, Sweden, Denmark, and Costa Rica have also achieved record-high rankings. Conversely, the United States has experienced a significant decline in its global happiness ranking.</li>
            </ul>
          </div>
        </section>
        <section class="didyouknow-featured featured-card">
          <div class="did-you-know">
            <h3>Did You Know?</h3>
            <p id="dyk-fact">Loading fact...</p>
            <button id="next-fact-btn" style="margin-top:10px;padding:6px 16px;background:#2196F3;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:1em;">Next Fact</button>
          </div>
        </section>
      </div>
      <div class="section-divider"></div>
      <div class="card">
        <div class="further-reading">
          <h2>Further Reading</h2>
          <div class="recommendations-container">
            <div class="recommendation-card">
              <h3>Based on your reading history</h3>
              <div class="recommendations-list" id="readingHistory">
                <!-- Recommendations will be dynamically loaded -->
              </div>
            </div>
            <div class="recommendation-card">
              <h3>Related Topics</h3>
              <div class="recommendations-list" id="relatedTopics">
                <!-- Related topics will be dynamically loaded -->
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="section-divider"></div>
      <div class="card wiki-sisters-languages">
        <div class="sister-projects-panel">
          <h3>Wikipedia's sister projects</h3>
          <p>Wikipedia is written by volunteer editors and hosted by the <a href="https://wikimediafoundation.org/" target="_blank">Wikimedia Foundation</a>, a non-profit organization that also hosts a range of other volunteer projects:</p>
          <div class="sister-projects-grid">
            <div class="sister-project"><span class="icon">🖼️</span> <a href="https://commons.wikimedia.org/" target="_blank"><b>Commons</b></a><br><span>Free media repository</span></div>
            <div class="sister-project"><span class="icon">📚</span> <a href="https://en.wikibooks.org/" target="_blank"><b>Wikibooks</b></a><br><span>Free textbooks and manuals</span></div>
            <div class="sister-project"><span class="icon">📊</span> <a href="https://www.wikidata.org/" target="_blank"><b>Wikidata</b></a><br><span>Free knowledge base</span></div>
            <div class="sister-project"><span class="icon">🌐</span> <a href="https://www.mediawiki.org/" target="_blank"><b>MediaWiki</b></a><br><span>Wiki software development</span></div>
            <div class="sister-project"><span class="icon">🌎</span> <a href="https://meta.wikimedia.org/" target="_blank"><b>Meta-Wiki</b></a><br><span>Wikimedia project coordination</span></div>
            <div class="sister-project"><span class="icon">📰</span> <a href="https://en.wikinews.org/" target="_blank"><b>Wikinews</b></a><br><span>Free-content news</span></div>
            <div class="sister-project"><span class="icon">💬</span> <a href="https://en.wikiquote.org/" target="_blank"><b>Wikiquote</b></a><br><span>Collection of quotations</span></div>
            <div class="sister-project"><span class="icon">📜</span> <a href="https://en.wikisource.org/" target="_blank"><b>Wikisource</b></a><br><span>Free-content library</span></div>
            <div class="sister-project"><span class="icon">🧬</span> <a href="https://species.wikimedia.org/" target="_blank"><b>Wikispecies</b></a><br><span>Directory of species</span></div>
            <div class="sister-project"><span class="icon">🎓</span> <a href="https://en.wikiversity.org/" target="_blank"><b>Wikiversity</b></a><br><span>Free learning tools</span></div>
            <div class="sister-project"><span class="icon">🧭</span> <a href="https://en.wikivoyage.org/" target="_blank"><b>Wikivoyage</b></a><br><span>Free travel guide</span></div>
            <div class="sister-project"><span class="icon">📖</span> <a href="https://en.wiktionary.org/" target="_blank"><b>Wiktionary</b></a><br><span>Dictionary and thesaurus</span></div>
          </div>
        </div>
        <div class="languages-panel">
          <h3>Wikipedia languages</h3>
          <p>This Wikipedia is written in <a href="#">English</a>. Many <a href="#">other Wikipedias are available</a>; some of the largest are listed below.</p>
          <div class="languages-group">
            <div class="lang-group-title">1,000,000+ articles</div>
            <div class="lang-list">العربية · Deutsch · Español · فارسی · Français · Italiano · Nederlands · 日本語 · Polski · Português · Русский · Svenska · Українська · Tiếng Việt · 中文</div>
          </div>
          <div class="languages-group">
            <div class="lang-group-title">250,000+ articles</div>
            <div class="lang-list">Bahasa Indonesia · Bahasa Melayu · Bân-lâmobtained-gú · Български · Català · Čeština · Dansk · Eesti · Esperanto · Euskara · עבר  · Hrvatski · 한국어 · Magyar · Norsk bokmål · Română · Simple English · Slovenčina · Srpski · Srpskohrvatski · Suomi · Türkçe · Oʻzbekcha</div>
          </div>
          <div class="languages-group">
  <!-- Navigation Overlay -->
  <div id="navOverlay" class="nav-overlay">
    <div class="nav-overlay-content">
      <button id="closeNavOverlay" class="close-nav-overlay" aria-label="Close menu">✖</button>
      <h3>Navigation</h3>
      <ul class="nav-overlay-list">
        <li><a href="#">About Wikipedia</a></li>
        <li><a href="#">Contents</a></li>
        <li><a href="#">Current Events</a></li>
        <li><a href="#">Main Page</a></li>
        <li><a href="#">Random Article</a></li>
      </ul>
      <h3>Contribute</h3>
      <ul class="nav-overlay-list">
        <li><a href="#">Community Portal</a></li>
        <li><a href="#">Help</a></li>
        <li><a href="#">Learn to Edit</a></li>
        <li><a href="#">Recent Changes</a></li>
      </ul>
    </div>
  </div>

  <script>
    // Add debug logging
    const debugStatus = document.getElementById('debug-status');
    function updateDebugStatus(message) {
      console.log(message);
      if (debugStatus) debugStatus.textContent = message;
    }

    // Initialize debug status
    updateDebugStatus('Page loaded, initializing...');

    // Close suggestions when clicking outside
    document.addEventListener('click', (e) => {
      const input = document.getElementById('searchInput');
      const suggestions = document.getElementById('searchSuggestions');
      if (e.target !== input && e.target !== suggestions) {
        if (suggestions) suggestions.style.display = 'none';
      }
    });

    // Did You Know (Static, Cycling)
    const facts = [
      "... that although the philosophical study of well-being dates back millennia, empirical research has intensified since the second half of the 20th century?",
      "... that an 1895 painting (pictured), depicting a woman clutching a crumpled letter, was described by a critic as 'a list of disasters'?",
      "... that Avi Yemini is one of seventeen children who were raised in an ultra-Orthodox Chabad family?",
      "... that Home of a Rebel Sharpshooter was staged by moving a corpse?",
      "... that just two weeks after a Florida TV station began using a news helicopter, it crashed, killing two of threeüzel occupants?",
      "... that Playboi Carti's song titled '2024' was first teased in 2023 and later officially released in 2025?",
      "... that Soemartini was appointed as the chief of the National Archives of Indonesia after working in the agency for a year?",
      "... that the 1982 film The Second November was filmed in colour, but shown in black-and-white until 2012?",
      "... that Wen Chia-ling, despite her family's initial opposition to her becoming an archer, helped Taiwan's team achieve its best-ever finish at the 2000 Summer Olympics?"
    ];
    let dykIndex = Math.floor(Math.random() * facts.length);
    function showFact() {
      const factElement = document.getElementById("dyk-fact");
      if (factElement) {
        factElement.textContent = facts[dykIndex];
      }
    }
    function nextFact() {
      let newIndex;
      do {
        newIndex = Math.floor(Math.random() * facts.length);
      } while (newIndex === dykIndex && facts.length > 1);
      dykIndex = newIndex;
      showFact();
    }

    // Hamburger menu overlay logic
    document.getElementById('navMenuBtn').onclick = function() {
      document.getElementById('navOverlay').classList.add('open');
    };
    document.getElementById('closeNavOverlay').onclick = function() {
      document.getElementById('navOverlay').classList.remove('open');
    };
    // Close overlay when clicking outside content
    document.getElementById('navOverlay').addEventListener('click', function(e) {
      if (e.target === this) {
        this.classList.remove('open');
      }
    });

    // Handle keyboard navigation
    const searchInput = document.getElementById('searchInput');
    if (searchInput) {
      searchInput.addEventListener('keydown', (e) => {
        const suggestions = document.getElementById('searchSuggestions');
        if (!suggestions) return;
        const items = suggestions.getElementsByTagName('li');
        let currentIndex = -1;

        for (let i = 0; i < items.length; i++) {
          if (items[i].classList.contains('active')) {
            currentIndex = i;
            break;
          }
        }

        if (e.key === 'ArrowDown') {
          e.preventDefault();
          if (currentIndex < items.length - 1) {
            if (currentIndex !== -1) items[currentIndex].classList.remove('active');
            items[currentIndex + 1].classList.add('active');
          }
        } else if (e.key === 'ArrowUp') {
          e.preventDefault();
          if (currentIndex > 0) {
            items[currentIndex].classList.remove('active');
            items[currentIndex - 1].classList.add('active');
          }
        } else if (e.key === 'Enter') {
          e.preventDefault();
          const activeItem = suggestions.querySelector('.active');
          if (activeItem) {
            searchInput.value = activeItem.textContent;
            suggestions.style.display = 'none';
            searchWikipedia();
          } else {
            searchWikipedia();
          }
        }
      });
    } else {
      console.error('Search input not found');
    }

    async function getSearchSuggestions() {
      const list = document.getElementById('searchSuggestions');
      const query = document.getElementById('searchInput')?.value.trim();
      if (!list) {
        console.error('Search suggestions list not found');
        return;
      }
      list.innerHTML = "";

      if (!query) {
        list.style.display = 'none';
        return;
      }

      try {
        const response = await fetch(`https://en.wikipedia.org/w/api.php?action=opensearch&search=${encodeURIComponent(query)}&limit=10&namespace=0&format=json&origin=*`);
        if (!response.ok) throw new Error('Failed to fetch search suggestions');
        const data = await response.json();

        const suggestions = data[1]; // Array of article titles

        if (suggestions.length > 0) {
          list.style.display = 'block';
          suggestions.forEach(item => {
            const li = document.createElement('li');
            li.textContent = item;
            li.onclick = () => {
              const searchInput = document.getElementById('searchInput');
              if (searchInput) searchInput.value = item;
              list.style.display = 'none';
              searchWikipedia();
            };
            list.appendChild(li);
          });
        } else {
          list.style.display = 'none';
        }
      } catch (err) {
        console.error("Error fetching suggestions:", err);
        list.style.display = 'none';
      }
    }

    async function fetchRandomArticle() {
      try {
        const response = await fetch('https://en.wikipedia.org/api/rest_v1/page/random/summary');
        if (!response.ok) {
          throw new Error('Failed to fetch random article');
        }
        const data = await response.json();

        // Update the featured section with the random article
        const featuredContent = document.querySelector('.featured-content');
        if (!featuredContent) {
          console.error('Featured content container not found');
          return;
        }
        featuredContent.innerHTML = `
          <h3>${data.title}</h3>
          <p>${data.extract}</p>
          <div class="article-meta">
            <a href="https://en.wikipedia.org/wiki/${encodeURIComponent(data.title)}" target="_blank" class="read-more">
              Read full article
            </a>
          </div>
        `;

        // Scroll to the featured section
        featuredContent.scrollIntoView({ behavior: 'smooth' });
      } catch (error) {
        console.error('Error fetching random article:', error);
        const featuredContent = document.querySelector('.featured-content');
        if (featuredContent) {
          featuredContent.innerHTML = `
            <div class="error-message">
              ❌ Failed to fetch random article. Please try again.
            </div>
          `;
        }
      }
    }

    // Table of Contents generation
    function generateTableOfContents() {
      const article = document.getElementById('articleContent');
      const toc = document.getElementById('tableOfContents');
      if (!article || !toc) return;
      const headings = article.querySelectorAll('h2, h3, h4, h5, h6');
      if (headings.length === 0) {
        toc.innerHTML = '';
        return;
      }
      let tocHtml = '<div class="toc-panel"><strong>Contents</strong><ul>';
      headings.forEach((heading, idx) => {
        if (!heading.id) heading.id = 'section-' + idx;
        tocHtml += `<li class="toc-level-${heading.tagName.toLowerCase()}"><a href="#${heading.id}">${heading.textContent}</a></li>`;
      });
      tocHtml += '</ul></div>';
      toc.innerHTML = tocHtml;
    }

    async function loadFeaturedArticle() {
      const featuredDiv = document.querySelector('.main-featured .featured-content');
      featuredDiv.innerHTML = '<div>Loading featured article...</div>';
      try {
        const today = new Date();
        const d = String(today.getDate()).padStart(2, '0');
        const m = String(today.getMonth() + 1).padStart(2, '0');
        const y = today.getFullYear();
        const url = `https://en.wikipedia.org/api/rest_v1/feed/featured/${y}/${m}/${d}`;
        const res = await fetch(url);
        if (!res.ok) throw new Error('Failed to fetch featured article');
        const data = await res.json();
        const article = data.tfa;
        featuredDiv.innerHTML = `
          <h3>${article.title}</h3>
          ${article.thumbnail ? `<img src="${article.thumbnail.source}" alt="${article.title}" style="max-width:120px;float:right;margin-left:16px;border-radius:8px;">` : ''}
          <p>${article.extract}</p>
          <a href="https://en.wikipedia.org/wiki/${encodeURIComponent(article.title)}" target="_blank" style="color:var(--primary-color);font-weight:500;">Read full article</a>
        `;
      } catch (e) {
        featuredDiv.innerHTML = '<div style="color:#dc3545;">Failed to load featured article.</div>';
      }
    }

    async function loadOnThisDay() {
      const otdDiv = document.querySelector('.onthisday-featured .onthisday-content');
      otdDiv.innerHTML = '<div>Loading events...</div>';
      try {
        const today = new Date();
        const d = today.getDate();
        const m = today.getMonth() + 1;
        const url = `https://en.wikipedia.org/api/rest_v1/feed/onthisday/events/${m}/${d}`;
        const res = await fetch(url);
        if (!res.ok) throw new Error('Failed to fetch events');
        const data = await res.json();
        otdDiv.innerHTML = '<ul>' + data.events.slice(0, 5).map(ev =>
          `<li>${ev.year}: <span>${ev.text}</span></li>`
        ).join('') + '</ul>';
      } catch (e) {
        otdDiv.innerHTML = '<div style="color:#dc3545;">Failed to load events.</div>';
      }
    }

    let currentArticleTitle = "";
    function showArticleModal(title) {
      currentArticleTitle = title;
      const iframe = document.getElementById('articleIframe');
      const modal = document.getElementById('articleModal');
      iframe.src = `https://en.wikipedia.org/wiki/${encodeURIComponent(currentArticleTitle)}`;
      modal.style.display = 'flex';
    }
    function closeArticleModal() {
      const iframe = document.getElementById('articleIframe');
      const modal = document.getElementById('articleModal');
      iframe.src = "";
      modal.style.display = 'none';
    }

    function showSearchResultsModal(html) {
      document.getElementById('modalResults').innerHTML = html;
      document.getElementById('searchResultsModal').style.display = 'flex';
    }
    function closeSearchResultsModal() {
      document.getElementById('modalResults').innerHTML = '';
      document.getElementById('searchResultsModal').style.display = 'none';
    }

    async function handleQuestion() {
      const question = document.getElementById('questionInput').value.trim();
      if (!question) return;

      const qaAnswer = document.getElementById('qaAnswer');
      qaAnswer.innerHTML = '<div class="loading">Processing your question...</div>';

      try {
        // Get the current article content
        const response = await fetch(`https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(currentArticleTitle)}`);
        if (!response.ok) throw new Error('Failed to fetch article');
        
        const data = await response.json();
        const context = data.extract;
        
        // Get the answer
        const answer = await askQuestion(question, context);
        
        // Display the answer
        qaAnswer.innerHTML = `
          <div class="answer-content">
            <h4>Question:</h4>
            <p>${question}</p>
            <h4>Answer:</h4>
            <p>${answer}</p>
          </div>
        `;
      } catch (error) {
        console.error('Error processing question:', error);
        qaAnswer.innerHTML = `
          <div class="error-message">
            ❌ Failed to process your question. Please try again.
          </div>
        `;
      }
    }

    // Modify the searchWikipedia function to update currentArticleTitle
    async function searchWikipedia() {
      const query = document.getElementById('searchInput').value.trim();
      if (!query) return;

      try {
        updateDebugStatus('Searching Wikipedia...');
        const response = await fetch(`https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(query)}`);
        if (!response.ok) throw new Error('Article not found');
        
        const data = await response.json();
        currentArticleTitle = data.title; // Store the current article title
        
        const resultsDiv = document.getElementById('results');
        
        resultsDiv.innerHTML = `
          <h2>${data.title}</h2>
          ${data.thumbnail ? `<img src="${data.thumbnail.source}" alt="${data.title}" style="max-width:200px;float:right;margin-left:20px;">` : ''}
          <p>${data.extract}</p>
          <div class="article-meta">
            <button onclick="handleArticleSummarization('${data.title}')" class="summarize-button">
              Generate AI Summary
            </button>
            <button onclick="generateQuiz('${data.title}')" class="generate-quiz-btn">
              Generate Quiz
            </button>
            <a href="https://en.wikipedia.org/wiki/${encodeURIComponent(data.title)}" target="_blank">
              Read full article
            </a>
          </div>
        `;
        
        // Show the quiz button
        document.querySelector('.generate-quiz-btn').style.display = 'inline-block';
        
        resultsDiv.scrollIntoView({ behavior: 'smooth' });
        updateDebugStatus('Search completed');
      } catch (error) {
        const resultsDiv = document.getElementById('results');
        resultsDiv.innerHTML = `
          <div class="error-message">
            ❌ No results found for "${query}". Try a different search term.
          </div>
        `;
        updateDebugStatus('Search failed');
      }
    }

    window.addEventListener('DOMContentLoaded', () => {
      const btn = document.getElementById('next-fact-btn');
      if (btn) btn.onclick = nextFact;
      loadFeaturedArticle();
      loadOnThisDay();
      showFact();
    });
  </script>
  <script src="script.js"></script>
</body>
</html>
